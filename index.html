<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>findbugs-slf4j by KengoTODA</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">findbugs-slf4j</h1>
      <h2 class="project-tagline">A SpotBugs/FindBugs plugin to verify usage of SLF4J</h2>
      <a href="https://github.com/KengoTODA/findbugs-slf4j" class="btn">View on GitHub</a>
      <a href="https://github.com/KengoTODA/findbugs-slf4j/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/KengoTODA/findbugs-slf4j/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="findbugs-bug-pattern-for-slf4j" class="anchor" href="#findbugs-bug-pattern-for-slf4j" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>SpotBugs bug pattern for SLF4J</h1>

<p>This product helps you to verify usage of SLF4J 1.6, 1.7 and 1.8. Works with Java8 and later.</p>

<p>To use this plugin with SonarQube, see <a href="https://github.com/KengoTODA/findbugs-slf4j/tree/master/sonar-plugin">here</a>. To detect problems at compile time, see <a href="https://github.com/KengoTODA/errorprone-slf4j">errorprone-slf4j</a>.</p>

<p><a href="http://travis-ci.org/KengoTODA/findbugs-slf4j"><img src="https://secure.travis-ci.org/KengoTODA/findbugs-slf4j.png" alt="Build Status"></a></p>

<h2>
<a id="motivation" class="anchor" href="#motivation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Motivation</h2>

<p>SLF4J is useful logging facade, but sometimes we mistake how to use. Can you find mistakes in following class? It is not so easy especially in huge product, this FindBugs plugin will help you to find.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">class</span> <span class="pl-en">Foo</span> {
    <span class="pl-k">private</span> <span class="pl-k">static</span> <span class="pl-k">final</span> <span class="pl-smi">Logger</span> logger <span class="pl-k">=</span> <span class="pl-smi">LoggerFactory</span><span class="pl-k">.</span>getLogger(<span class="pl-smi">Bar</span><span class="pl-k">.</span>class);

    <span class="pl-k">void</span> <span class="pl-en">rethrow</span>(<span class="pl-smi">String</span> <span class="pl-v">name</span>, <span class="pl-smi">Throwable</span> <span class="pl-v">t</span>) {
        logger<span class="pl-k">.</span>info(<span class="pl-s"><span class="pl-pds">"</span>Hello, {}!<span class="pl-pds">"</span></span>);
        logger<span class="pl-k">.</span>warn(<span class="pl-s"><span class="pl-pds">"</span>Now I will wrap and throw {}<span class="pl-pds">"</span></span>, t);
        <span class="pl-k">throw</span> <span class="pl-k">new</span> <span class="pl-smi">RuntimeException</span>(t);
    }
}</pre></div>

<h1>
<a id="provided-bug-patterns" class="anchor" href="#provided-bug-patterns" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Provided bug patterns</h1>

<p>Currently this product provides 9 patterns.</p>

<h2>
<a id="slf4j_place_holder_mismatch" class="anchor" href="#slf4j_place_holder_mismatch" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>SLF4J_PLACE_HOLDER_MISMATCH</h2>

<p>This pattern checks how placeholder is used.
Alert if count of placeholder does not match to count of parameter.</p>

<p>Note:
  Format should be CONST to use this bug pattern. Use SLF4J_FORMAT_SHOULD_BE_CONST bug pattern to check it.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">class</span> <span class="pl-en">Foo</span> {
    <span class="pl-k">private</span> <span class="pl-k">final</span> <span class="pl-smi">Logger</span> logger <span class="pl-k">=</span> <span class="pl-smi">LoggerFactory</span><span class="pl-k">.</span>getLogger(getClass());
    <span class="pl-k">void</span> <span class="pl-en">method</span>() {
        <span class="pl-c">// invalid: this logging method has 2 placeholders, but given parameter is only 1.</span>
        logger<span class="pl-k">.</span>info(<span class="pl-s"><span class="pl-pds">"</span>{}, {}.<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Hello<span class="pl-pds">"</span></span>);

        <span class="pl-c">// valid</span>
        logger<span class="pl-k">.</span>info(<span class="pl-s"><span class="pl-pds">"</span>{}, {}.<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Hello<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>World<span class="pl-pds">"</span></span>);

        <span class="pl-c">// invalid: Throwable instance does not need placeholder</span>
        logger<span class="pl-k">.</span>error(<span class="pl-s"><span class="pl-pds">"</span>{}, {}<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Hello<span class="pl-pds">"</span></span>, <span class="pl-k">new</span> <span class="pl-smi">RuntimeException</span>());

        <span class="pl-c">// valid</span>
        logger<span class="pl-k">.</span>error(<span class="pl-s"><span class="pl-pds">"</span>{}<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Hello<span class="pl-pds">"</span></span>, <span class="pl-k">new</span> <span class="pl-smi">RuntimeException</span>());
    }
}</pre></div>

<h2>
<a id="slf4j_format_should_be_const" class="anchor" href="#slf4j_format_should_be_const" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>SLF4J_FORMAT_SHOULD_BE_CONST</h2>

<p>This pattern checks given format is CONST or not.
Alert if format is not CONST.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">class</span> <span class="pl-en">Foo</span> {
    <span class="pl-k">private</span> <span class="pl-k">final</span> <span class="pl-smi">Logger</span> logger <span class="pl-k">=</span> <span class="pl-smi">LoggerFactory</span><span class="pl-k">.</span>getLogger(getClass());
    <span class="pl-k">void</span> <span class="pl-en">method</span>() {
        <span class="pl-c">// invalid: format is not CONST</span>
        <span class="pl-smi">String</span> format <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">String</span>(<span class="pl-s"><span class="pl-pds">"</span>Hello, <span class="pl-pds">"</span></span>);
        logger<span class="pl-k">.</span>info(format <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span>{}.<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>World<span class="pl-pds">"</span></span>);

        <span class="pl-c">// valid</span>
        logger<span class="pl-k">.</span>info(<span class="pl-s"><span class="pl-pds">"</span>Hello, {}.<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>World<span class="pl-pds">"</span></span>);
    }
}</pre></div>

<h2>
<a id="slf4j_unknown_array" class="anchor" href="#slf4j_unknown_array" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>SLF4J_UNKNOWN_ARRAY</h2>

<p>This pattern reports a bug if your code is using array which is provided as method argument or returned from other method.
It makes our verification harder, so please stop using it.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">class</span> <span class="pl-en">Foo</span> {
    <span class="pl-k">private</span> <span class="pl-k">final</span> <span class="pl-smi">Logger</span> logger <span class="pl-k">=</span> <span class="pl-smi">LoggerFactory</span><span class="pl-k">.</span>getLogger(getClass());
    <span class="pl-k">void</span> <span class="pl-en">method</span>(<span class="pl-k">Object</span>[] <span class="pl-v">args</span>) {
        <span class="pl-c">// invalid: using method argument as parameter</span>
        logger<span class="pl-k">.</span>info(<span class="pl-s"><span class="pl-pds">"</span>Hello, {}.<span class="pl-pds">"</span></span>, args);

        <span class="pl-c">// valid</span>
        logger<span class="pl-k">.</span>info(<span class="pl-s"><span class="pl-pds">"</span>Hello, {}.<span class="pl-pds">"</span></span>, <span class="pl-k">new</span> <span class="pl-smi">Object</span>[]{ <span class="pl-s"><span class="pl-pds">"</span>World<span class="pl-pds">"</span></span> });
    }
}</pre></div>

<h2>
<a id="slf4j_logger_should_be_private" class="anchor" href="#slf4j_logger_should_be_private" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>SLF4J_LOGGER_SHOULD_BE_PRIVATE</h2>

<p>This pattern reports non private field whose type is org.slf4j.Logger.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">class</span> <span class="pl-en">Foo</span> {
    <span class="pl-c">// invalid: field is not private</span>
    <span class="pl-k">public</span> <span class="pl-k">final</span> <span class="pl-smi">Logger</span> logger <span class="pl-k">=</span> <span class="pl-smi">LoggerFactory</span><span class="pl-k">.</span>getLogger(getClass());

    <span class="pl-c">// valid</span>
    <span class="pl-k">private</span> <span class="pl-k">final</span> <span class="pl-smi">Logger</span> logger <span class="pl-k">=</span> <span class="pl-smi">LoggerFactory</span><span class="pl-k">.</span>getLogger(getClass());
}</pre></div>

<h2>
<a id="slf4j_logger_should_be_final" class="anchor" href="#slf4j_logger_should_be_final" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>SLF4J_LOGGER_SHOULD_BE_FINAL</h2>

<p>This pattern reports non final field whose type is org.slf4j.Logger.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">class</span> <span class="pl-en">Foo</span> {
    <span class="pl-c">// invalid: field is not final</span>
    <span class="pl-k">private</span> <span class="pl-smi">Logger</span> logger <span class="pl-k">=</span> <span class="pl-smi">LoggerFactory</span><span class="pl-k">.</span>getLogger(getClass());

    <span class="pl-c">// valid</span>
    <span class="pl-k">private</span> <span class="pl-k">final</span> <span class="pl-smi">Logger</span> logger <span class="pl-k">=</span> <span class="pl-smi">LoggerFactory</span><span class="pl-k">.</span>getLogger(getClass());
}</pre></div>

<h2>
<a id="slf4j_logger_should_be_non_static" class="anchor" href="#slf4j_logger_should_be_non_static" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>SLF4J_LOGGER_SHOULD_BE_NON_STATIC</h2>

<p>This pattern reports static field whose type is org.slf4j.Logger.</p>

<p>Sometimes using static logger is better than using non-static one. See <a href="http://www.slf4j.org/faq.html#declared_static">official FAQ</a> for detail.</p>

<p>If you need to use static logger, you can use <a href="http://pmd.sourceforge.net/pmd-5.0.0/rules/java/logging-java.html#LoggerIsNotStaticFinal">PMD's default rule for logger</a> instead.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">class</span> <span class="pl-en">Foo</span> {
    <span class="pl-c">// invalid: field is static</span>
    <span class="pl-k">private</span> <span class="pl-k">static</span> <span class="pl-k">final</span> <span class="pl-smi">Logger</span> <span class="pl-c1">LOGGER</span> <span class="pl-k">=</span> <span class="pl-smi">LoggerFactory</span><span class="pl-k">.</span>getLogger(<span class="pl-smi">Foo</span><span class="pl-k">.</span>class);

    <span class="pl-c">// valid</span>
    <span class="pl-k">private</span> <span class="pl-k">final</span> <span class="pl-smi">Logger</span> logger <span class="pl-k">=</span> <span class="pl-smi">LoggerFactory</span><span class="pl-k">.</span>getLogger(getClass());
}</pre></div>

<h2>
<a id="slf4j_illegal_passed_class" class="anchor" href="#slf4j_illegal_passed_class" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>SLF4J_ILLEGAL_PASSED_CLASS</h2>

<p>This pattern reports that illegal class is passed to LoggerFactory.getLogger(Class)</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">class</span> <span class="pl-en">Foo</span> {
    <span class="pl-c">// invalid: illegal class is passed to Factory</span>
    <span class="pl-k">private</span> <span class="pl-k">final</span> <span class="pl-smi">Logger</span> logger <span class="pl-k">=</span> <span class="pl-smi">LoggerFactory</span><span class="pl-k">.</span>getLogger(<span class="pl-smi">Bar</span><span class="pl-k">.</span>class);

    <span class="pl-c">// valid</span>
    <span class="pl-k">private</span> <span class="pl-k">final</span> <span class="pl-smi">Logger</span> logger <span class="pl-k">=</span> <span class="pl-smi">LoggerFactory</span><span class="pl-k">.</span>getLogger(getClass());
    <span class="pl-k">private</span> <span class="pl-k">final</span> <span class="pl-smi">Logger</span> logger <span class="pl-k">=</span> <span class="pl-smi">LoggerFactory</span><span class="pl-k">.</span>getLogger(<span class="pl-smi">Foo</span><span class="pl-k">.</span>class);
}</pre></div>

<h2>
<a id="slf4j_sign_only_format" class="anchor" href="#slf4j_sign_only_format" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>SLF4J_SIGN_ONLY_FORMAT</h2>

<p>This pattern reports that log format which contains only sign and spaces.
To make log readable, you have to use letter to explain your log.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">class</span> <span class="pl-en">Foo</span> {
    <span class="pl-k">private</span> <span class="pl-k">final</span> <span class="pl-smi">Logger</span> logger <span class="pl-k">=</span> <span class="pl-smi">LoggerFactory</span><span class="pl-k">.</span>getLogger(getClass());
    <span class="pl-k">void</span> <span class="pl-en">method</span>() {
        <span class="pl-c">// invalid: bad readability</span>
        logger<span class="pl-k">.</span>info(<span class="pl-s"><span class="pl-pds">"</span>{}<span class="pl-pds">"</span></span>, id);

        <span class="pl-c">// valid</span>
        logger<span class="pl-k">.</span>info(<span class="pl-s"><span class="pl-pds">"</span>{} signed in<span class="pl-pds">"</span></span>, userId);
    }
}</pre></div>

<h2>
<a id="slf4j_manually_provided_message" class="anchor" href="#slf4j_manually_provided_message" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>SLF4J_MANUALLY_PROVIDED_MESSAGE</h2>

<p>This pattern reports needless message which is returned by <code>Throwable#getMessage()</code>
or <code>Throwable#getLocalizedMessage()</code>. Normally binding will call these methods
when you provide throwable instance as the last argument, so you do not have to
call them manually.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">class</span> <span class="pl-en">Foo</span> {
    <span class="pl-k">private</span> <span class="pl-k">final</span> <span class="pl-smi">Logger</span> logger <span class="pl-k">=</span> <span class="pl-smi">LoggerFactory</span><span class="pl-k">.</span>getLogger(getClass());
    <span class="pl-k">void</span> <span class="pl-en">method</span>() {
        <span class="pl-c">// invalid: needless 'e.getMessage()'</span>
        logger<span class="pl-k">.</span>info(<span class="pl-s"><span class="pl-pds">"</span>Error occured. Message is {}<span class="pl-pds">"</span></span>, e<span class="pl-k">.</span>getMessage(), e);

        <span class="pl-c">// valid</span>
        logger<span class="pl-k">.</span>info(<span class="pl-s"><span class="pl-pds">"</span>Error occured.<span class="pl-pds">"</span></span>, e);
    }
}</pre></div>

<h1>
<a id="how-to-use-with-maven" class="anchor" href="#how-to-use-with-maven" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>how to use with Maven</h1>

<p>To use this product, please configure your spotbugs-maven-plugin like below.</p>

<div class="highlight highlight-text-xml"><pre>      &lt;<span class="pl-ent">plugin</span>&gt;
        &lt;<span class="pl-ent">groupId</span>&gt;com.github.spotbugs&lt;/<span class="pl-ent">groupId</span>&gt;
        &lt;<span class="pl-ent">artifactId</span>&gt;spotbugs-maven-plugin&lt;/<span class="pl-ent">artifactId</span>&gt;
        &lt;<span class="pl-ent">version</span>&gt;3.1.12&lt;/<span class="pl-ent">version</span>&gt;
        &lt;<span class="pl-ent">configuration</span>&gt;
          &lt;<span class="pl-ent">plugins</span>&gt;
            &lt;<span class="pl-ent">plugin</span>&gt;
              &lt;<span class="pl-ent">groupId</span>&gt;jp.skypencil.findbugs.slf4j&lt;/<span class="pl-ent">groupId</span>&gt;
              &lt;<span class="pl-ent">artifactId</span>&gt;bug-pattern&lt;/<span class="pl-ent">artifactId</span>&gt;
              &lt;<span class="pl-ent">version</span>&gt;1.5.0&lt;/<span class="pl-ent">version</span>&gt;
            &lt;/<span class="pl-ent">plugin</span>&gt;
          &lt;/<span class="pl-ent">plugins</span>&gt;
        &lt;/<span class="pl-ent">configuration</span>&gt;
      &lt;/<span class="pl-ent">plugin</span>&gt;</pre></div>

<h1>
<a id="change-log" class="anchor" href="#change-log" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Change log</h1>

<p>See <a href="CHANGELOG.md">CHANGELOG.md</a> for detail.</p>

<h1>
<a id="copyright-and-license" class="anchor" href="#copyright-and-license" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Copyright and license</h1>

<p>Copyright 2012-present Kengo TODA</p>

<p>Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p>

<pre><code>http://www.apache.org/licenses/LICENSE-2.0
</code></pre>

<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/KengoTODA/findbugs-slf4j">findbugs-slf4j</a> is maintained by <a href="https://github.com/KengoTODA">KengoTODA</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-16698566-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
